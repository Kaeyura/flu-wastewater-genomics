<pre> # California Influenza A (2024-2025) Genomic Analysis Pipeline This repository contains a suite of Python scripts designed to track antigenic drift of the Influenza A virus during the 2024-2025 season in California. The pipeline quantifies genetic diversity using Shannon entropy and correlates molecular evolution with temporal windows, wastewater surveillance, and CDC morbidity trends. --- ## Overview This pipeline uses a high-precision curation strategy that avoids traditional multiple-sequence alignment. Instead, it enforces exact-length coding sequences starting at the ATG start codon, creating an implicit alignment across all samples. This approach minimizes artifacts from incomplete sequencing while preserving true biological variation. --- ## Key Research Questions 1. How does genetic diversity of the Hemagglutinin (HA) gene change over the California flu season? 2. Does the HA1 (head) domain evolve faster than the HA2 (stalk) domain? 3. Can genomic entropy act as a leading indicator of clinical disease surges? --- ## 1. Sequence Downloader (fetch_ncbi.py) Automates retrieval of FASTA records from the NCBI Nucleotide database and performs metadata injection by embedding collection dates into FASTA headers. ### Usage python fetch_ncbi.py &lt;metadata_csv&gt; &lt;output_fasta&gt; ### Arguments - metadata_csv CSV containing Accession and Collection_Date columns - output_fasta Output FASTA file with annotated headers ### Dependencies - requests - biopython --- ## 2. Length Curation Filter (curate_lengths.py) Primary quality-control step. Filters sequences by exact nucleotide length to remove incomplete records and sequencing artifacts that can artificially inflate entropy. ### Usage python curate_lengths.py &lt;input_fasta&gt; &lt;output_fasta&gt; &lt;target_length&gt; ### Target Lengths - 1701 bp for Hemagglutinin (HA / Segment 4) - 1497 bp for Nucleoprotein (NP / Segment 5) ### Biological Rationale By enforcing fixed-length sequences starting at the ATG codon, each nucleotide position corresponds to the same biological site across all samples, effectively aligning sequences without a traditional multiple sequence alignment step. --- ## 3. Genomic Analysis Engine (flu_analysis.py) Partitions curated sequences into seasonal windows and computes evolutionary metrics. ### Usage python flu_analysis.py --ha curated_ha.fasta --np curated_np.fasta ### Metrics Calculated - Shannon Entropy (H) H = - sum(p_i * log2(p_i)) - Temporal Windows Early: September to November Mid: November to January Late: January to March - Domain Slicing HA1 (head) versus HA2 (stalk) - Translation Analysis Translates nucleotide sequences to amino acids Identifies non-synonymous mutations affecting protein structure --- ## Results Summary (California 2024-2025) Metric | HA (Segment 4) | NP (Segment 5) | Interpretation --- | --- | --- | --- Early Entropy | 0.0287 | 0.0126 | Baseline seasonal diversity Mid Entropy | 0.0347 | 0.0149 | Peak circulation and drift initiation Late Entropy | 0.0450 | 0.0158 | Significant surface protein drift HA1 AA Entropy | 0.0445 | N/A | Strong immune selection pressure HA2 AA Entropy | 0.0267 | N/A | Structural conservation Key Insight: HA diversity rises sharply mid-to-late season, consistent with immune-driven antigenic drift, while NP remains comparatively conserved. --- ## Installation and Requirements ### Clone the repository git clone https://github.com/yourusername/california-flu-analysis.git cd california-flu-analysis ### Install dependencies pip install biopython requests --- ## License MIT License </pre>
